<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width">
<meta name="theme-color" content="#222"><meta name="generator" content="Hexo 7.3.0">

  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">
  <meta name="msvalidate.01" content="09940DFE4C5DA4E85A7117EF7EEC3933">

<link rel="stylesheet" href="/css/main.css">



<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/7.0.0/css/all.min.css" integrity="sha256-VHqXKFhhMxcpubYf9xiWdCiojEbY9NexQ4jh8AxbvcM=" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/3.1.1/animate.min.css" integrity="sha256-PR7ttpcvz8qrF57fur/yAx1qXMFJeJFiA6pSzWi0OIE=" crossorigin="anonymous">

<script class="next-config" data-name="main" type="application/json">{"hostname":"acomma.github.io","root":"/","images":"/images","scheme":"Pisces","darkmode":false,"version":"8.26.0","exturl":false,"sidebar":{"position":"left","width_expanded":320,"width_dual_column":240,"display":"post","padding":18,"offset":12},"hljswrap":true,"codeblock":{"theme":{"light":"default","dark":"stackoverflow-dark"},"prism":{"light":"prism","dark":"prism-dark"},"copy_button":{"enable":true,"style":null},"fold":{"enable":false,"height":500},"language":false},"bookmark":{"enable":false,"color":"#222","save":"auto"},"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"stickytabs":false,"motion":{"enable":true,"async":false,"duration":200,"transition":{"menu_item":"fadeInDown","post_block":"fadeIn","post_header":"fadeInDown","post_body":"fadeInDown","coll_header":"fadeInLeft","sidebar":"fadeInUp"}},"prism":false,"i18n":{"placeholder":"搜索...","empty":"没有找到任何搜索结果：${query}","hits_time":"找到 ${hits} 个搜索结果（用时 ${time} 毫秒）","hits":"找到 ${hits} 个搜索结果"}}</script><script src="/js/config.js" defer></script>

    <meta name="description" content="在 Spring Boot 应用中使用 org.springframework.ai:spring-ai-starter-mcp-server-webflux:1.1.0 可以创建一个 MCP 服务器，如果想在一个应用创建多个 MCP 服务器，每个服务器使用不同的配置，比如不同的协议，该怎么实现呢？通过阅读 MCP 相关的源代码发现创建一个 MCP 服务器会向 Spring 容器注册 3 个对象（">
<meta property="og:type" content="article">
<meta property="og:title" content="在 Spring Boot 应用中动态创建&#x2F;销毁 MCP 服务器">
<meta property="og:url" content="https://acomma.github.io/2025/11/15/dynamic-server-in-spring-ai-model-context-protocol/index.html">
<meta property="og:site_name" content="逗号的博客">
<meta property="og:description" content="在 Spring Boot 应用中使用 org.springframework.ai:spring-ai-starter-mcp-server-webflux:1.1.0 可以创建一个 MCP 服务器，如果想在一个应用创建多个 MCP 服务器，每个服务器使用不同的配置，比如不同的协议，该怎么实现呢？通过阅读 MCP 相关的源代码发现创建一个 MCP 服务器会向 Spring 容器注册 3 个对象（">
<meta property="og:locale" content="zh_CN">
<meta property="article:published_time" content="2025-11-15T13:10:18.000Z">
<meta property="article:modified_time" content="2025-11-15T13:10:18.000Z">
<meta property="article:author" content="逗号">
<meta property="article:tag" content="Spring AI">
<meta property="article:tag" content="MCP">
<meta name="twitter:card" content="summary">


<link rel="canonical" href="https://acomma.github.io/2025/11/15/dynamic-server-in-spring-ai-model-context-protocol/">


<script class="next-config" data-name="page" type="application/json">{"sidebar":"","isHome":false,"isPost":true,"lang":"zh-CN","comments":true,"permalink":"https://acomma.github.io/2025/11/15/dynamic-server-in-spring-ai-model-context-protocol/","path":"2025/11/15/dynamic-server-in-spring-ai-model-context-protocol/","title":"在 Spring Boot 应用中动态创建/销毁 MCP 服务器"}</script>

<script class="next-config" data-name="calendar" type="application/json">""</script>
<title>在 Spring Boot 应用中动态创建/销毁 MCP 服务器 | 逗号的博客</title>
  








  
  <script src="https://cdnjs.cloudflare.com/ajax/libs/animejs/3.2.1/anime.min.js" integrity="sha256-XL2inqUJaslATFnHdJOi9GfQ60on8Wx1C2H8DYiN1xY=" crossorigin="anonymous" defer></script>
<script src="/js/utils.js" defer></script><script src="/js/motion.js" defer></script><script src="/js/sidebar.js" defer></script><script src="/js/next-boot.js" defer></script>

  

  <script class="next-config" data-name="mermaid" type="application/json">{"enable":true,"theme":{"light":"default","dark":"dark"},"js":{"url":"https://cdnjs.cloudflare.com/ajax/libs/mermaid/11.10.1/mermaid.min.js","integrity":"sha256-BmQmdWDS8X2OTbrwELWK366LV6escyWhHHe0XCTU/Hk="}}</script>
  <script src="/js/third-party/tags/mermaid.js" defer></script>





  





  <noscript>
    <link rel="stylesheet" href="/css/noscript.css">
  </noscript>
</head>

<body itemscope itemtype="http://schema.org/WebPage" class="use-motion">
  <div class="headband"></div>

  <main class="main">
    <div class="column">
      <header class="header" itemscope itemtype="http://schema.org/WPHeader"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="切换导航栏" role="button">
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <i class="logo-line"></i>
      <p class="site-title">逗号的博客</p>
      <i class="logo-line"></i>
    </a>
      <p class="site-subtitle" itemprop="description">这里有一句格言，但我还没想好</p>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger" aria-label="搜索" role="button">
    </div>
  </div>
</div>



<nav class="site-nav">
  <ul class="main-menu menu"><li class="menu-item menu-item-home"><a href="/" rel="section"><i class="fa fa-home fa-fw"></i>首页</a></li><li class="menu-item menu-item-tags"><a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>标签</a></li><li class="menu-item menu-item-archives"><a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>归档</a></li>
  </ul>
</nav>




</header>
        
  
  <aside class="sidebar">

    <div class="sidebar-inner sidebar-nav-active sidebar-toc-active">
      <ul class="sidebar-nav">
        <li class="sidebar-nav-toc">
          文章目录
        </li>
        <li class="sidebar-nav-overview">
          站点概览
        </li>
      </ul>

      <div class="sidebar-panel-container">
        <!--noindex-->
        <div class="post-toc-wrap sidebar-panel">
            <div class="post-toc animated"><ol class="nav"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6"><span class="nav-number">1.</span> <span class="nav-text">配置文件</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E8%BE%85%E5%8A%A9%E5%B7%A5%E5%85%B7"><span class="nav-number">2.</span> <span class="nav-text">辅助工具</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%8A%A8%E6%80%81%E8%B7%AF%E7%94%B1"><span class="nav-number">3.</span> <span class="nav-text">动态路由</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%8A%A8%E6%80%81%E6%9C%8D%E5%8A%A1"><span class="nav-number">4.</span> <span class="nav-text">动态服务</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%95%B4%E5%90%88%E9%9B%86%E6%88%90"><span class="nav-number">5.</span> <span class="nav-text">整合集成</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99"><span class="nav-number">6.</span> <span class="nav-text">参考资料</span></a></li></ol></div>
        </div>
        <!--/noindex-->

        <div class="site-overview-wrap sidebar-panel">
          <div class="site-author animated" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image" alt="逗号"
      src="/images/avatar.jpg">
  <p class="site-author-name" itemprop="name">逗号</p>
  <div class="site-description" itemprop="description">这里是站点描述，但我没有写</div>
</div>
<div class="site-state-wrap animated">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
        <a href="/archives/">
          <span class="site-state-item-count">38</span>
          <span class="site-state-item-name">日志</span>
        </a>
      </div>
      <div class="site-state-item site-state-tags">
          <a href="/tags/">
        <span class="site-state-item-count">30</span>
        <span class="site-state-item-name">标签</span></a>
      </div>
  </nav>
</div>
  <div class="links-of-author animated">
      <span class="links-of-author-item">
        <a href="https://github.com/acomma" title="GitHub → https:&#x2F;&#x2F;github.com&#x2F;acomma" rel="noopener me" target="_blank"><i class="fab fa-github fa-fw"></i>GitHub</a>
      </span>
      <span class="links-of-author-item">
        <a href="mailto:acomma@yeah.net" title="E-Mail → mailto:acomma@yeah.net" rel="noopener me" target="_blank"><i class="fa fa-envelope fa-fw"></i>E-Mail</a>
      </span>
  </div>
  <div class="cc-license animated" itemprop="license">
    <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/deed.zh" class="cc-opacity" rel="noopener" target="_blank"><img src="https://cdnjs.cloudflare.com/ajax/libs/creativecommons-vocabulary/2020.11.3/assets/license_badges/small/by_nc_sa.svg" alt="Creative Commons"></a>
  </div>

        </div>
      </div>
    </div>

    
  </aside>


    </div>

    <div class="main-inner post posts-expand">


  


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://acomma.github.io/2025/11/15/dynamic-server-in-spring-ai-model-context-protocol/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.jpg">
      <meta itemprop="name" content="逗号">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="逗号的博客">
      <meta itemprop="description" content="这里是站点描述，但我没有写">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="在 Spring Boot 应用中动态创建&#x2F;销毁 MCP 服务器 | 逗号的博客">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          在 Spring Boot 应用中动态创建/销毁 MCP 服务器
        </h1>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2025-11-15 21:10:18" itemprop="dateCreated datePublished" datetime="2025-11-15T21:10:18+08:00">2025-11-15</time>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody"><p>在 Spring Boot 应用中使用 <code>org.springframework.ai:spring-ai-starter-mcp-server-webflux:1.1.0</code> 可以创建一个 MCP 服务器，如果想在一个应用创建多个 MCP 服务器，每个服务器使用不同的配置，比如不同的协议，该怎么实现呢？通过阅读 MCP 相关的源代码发现创建一个 MCP 服务器会向 Spring 容器注册 3 个对象（以异步的 Streamable HTTP 为例）：<br><code>WebFluxStreamableServerTransportProvider</code>、<code>RouterFunction</code>、<code>McpAsyncServer</code>，只要能在应用启动中或启动后从配置文件或数据库读取配置然后创建这些对象，就可以实现动态创建&#x2F;销毁 MCP 服务器。</p>
<span id="more"></span>

<h2 id="配置文件"><a href="#配置文件" class="headerlink" title="配置文件"></a>配置文件</h2><p>这里简单地使用配置文件来配置 MCP 服务器，因此需要定义一个配置属性的承载对象</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> org.springframework.ai.mcp.server.common.autoconfigure.properties.McpServerProperties;</span><br><span class="line"><span class="keyword">import</span> org.springframework.boot.context.properties.ConfigurationProperties;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.HashMap;</span><br><span class="line"><span class="keyword">import</span> java.util.HashSet;</span><br><span class="line"><span class="keyword">import</span> java.util.Map;</span><br><span class="line"><span class="keyword">import</span> java.util.Set;</span><br><span class="line"></span><br><span class="line"><span class="meta">@ConfigurationProperties(DynamicMcpServerProperties.CONFIG_PREFIX)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">DynamicMcpServerProperties</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">String</span> <span class="variable">CONFIG_PREFIX</span> <span class="operator">=</span> <span class="string">&quot;spring.ai.mcp.server.dynamic&quot;</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> Map&lt;String, ServerParameters&gt; servers = <span class="keyword">new</span> <span class="title class_">HashMap</span>&lt;&gt;();</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> Map&lt;String, ServerParameters&gt; <span class="title function_">getServers</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">this</span>.servers;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">class</span> <span class="title class_">ServerParameters</span> &#123;</span><br><span class="line">        <span class="keyword">private</span> <span class="type">boolean</span> <span class="variable">enabled</span> <span class="operator">=</span> <span class="literal">true</span>;</span><br><span class="line">        <span class="keyword">private</span> <span class="type">String</span> <span class="variable">version</span> <span class="operator">=</span> <span class="string">&quot;1.0.0&quot;</span>;</span><br><span class="line">        <span class="keyword">private</span> McpServerProperties.ServerProtocol protocol;</span><br><span class="line">        <span class="keyword">private</span> Set&lt;String&gt; toolObjectNames = <span class="keyword">new</span> <span class="title class_">HashSet</span>&lt;&gt;();</span><br><span class="line"></span><br><span class="line">        <span class="keyword">public</span> <span class="type">boolean</span> <span class="title function_">isEnabled</span><span class="params">()</span> &#123;</span><br><span class="line">            <span class="keyword">return</span> enabled;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setEnabled</span><span class="params">(<span class="type">boolean</span> enabled)</span> &#123;</span><br><span class="line">            <span class="built_in">this</span>.enabled = enabled;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">public</span> String <span class="title function_">getVersion</span><span class="params">()</span> &#123;</span><br><span class="line">            <span class="keyword">return</span> version;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setVersion</span><span class="params">(String version)</span> &#123;</span><br><span class="line">            <span class="built_in">this</span>.version = version;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">public</span> McpServerProperties.ServerProtocol <span class="title function_">getProtocol</span><span class="params">()</span> &#123;</span><br><span class="line">            <span class="keyword">return</span> protocol;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setProtocol</span><span class="params">(McpServerProperties.ServerProtocol protocol)</span> &#123;</span><br><span class="line">            <span class="built_in">this</span>.protocol = protocol;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">public</span> Set&lt;String&gt; <span class="title function_">getToolObjectNames</span><span class="params">()</span> &#123;</span><br><span class="line">            <span class="keyword">return</span> toolObjectNames;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setToolObjectNames</span><span class="params">(Set&lt;String&gt; toolObjectNames)</span> &#123;</span><br><span class="line">            <span class="built_in">this</span>.toolObjectNames = toolObjectNames;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><code>servers</code> 配置的 <em>KEY</em> 为 MCP 服务器的名字，这个名字会作为访问端点的一部分；<code>tool-object-names</code> 是包含 <code>@Tool</code> 注解的 Bean 的名字。在这种方式下配置文件的示例如下所示</p>
<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">server:</span></span><br><span class="line">  <span class="attr">port:</span> <span class="number">9093</span></span><br><span class="line"><span class="attr">spring:</span></span><br><span class="line">  <span class="attr">application:</span></span><br><span class="line">    <span class="attr">name:</span> <span class="string">dynamic-mcp-server</span></span><br><span class="line">  <span class="attr">ai:</span></span><br><span class="line">    <span class="attr">mcp:</span></span><br><span class="line">      <span class="attr">server:</span></span><br><span class="line">        <span class="attr">dynamic:</span></span><br><span class="line">          <span class="attr">servers:</span></span><br><span class="line">            <span class="attr">mcp-server1:</span></span><br><span class="line">              <span class="attr">enabled:</span> <span class="literal">true</span></span><br><span class="line">              <span class="attr">protocol:</span> <span class="string">SSE</span></span><br><span class="line">              <span class="attr">version:</span> <span class="number">1.0</span><span class="number">.0</span></span><br><span class="line">              <span class="attr">tool-object-names:</span></span><br><span class="line">                <span class="bullet">-</span> <span class="string">orderService</span></span><br><span class="line">            <span class="attr">mcp-server2:</span></span><br><span class="line">              <span class="attr">enabled:</span> <span class="literal">true</span></span><br><span class="line">              <span class="attr">protocol:</span> <span class="string">STREAMABLE</span></span><br><span class="line">              <span class="attr">version:</span> <span class="number">1.0</span><span class="number">.0</span></span><br><span class="line">              <span class="attr">tool-object-names:</span></span><br><span class="line">                <span class="bullet">-</span> <span class="string">weatherService</span></span><br></pre></td></tr></table></figure>

<p>在上述配置示例下，MCP 服务器的访问端点分别为 <code>http://localhost:9093/mcp-server1/sse</code> 和 <code>http://localhost:9093/mcp-server2/mcp</code>。</p>
<h2 id="辅助工具"><a href="#辅助工具" class="headerlink" title="辅助工具"></a>辅助工具</h2><p>为了方便向 Spring 容器注册 Bean 和从 Spring 容器中获取 Bean，需要定义一个工具类</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> org.springframework.beans.BeansException;</span><br><span class="line"><span class="keyword">import</span> org.springframework.beans.factory.support.DefaultListableBeanFactory;</span><br><span class="line"><span class="keyword">import</span> org.springframework.context.ApplicationContext;</span><br><span class="line"><span class="keyword">import</span> org.springframework.context.ConfigurableApplicationContext;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">final</span> <span class="keyword">class</span> <span class="title class_">SpringBeanUtils</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">SpringBeanUtils</span> <span class="variable">INSTANCE</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">SpringBeanUtils</span>();</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> ApplicationContext applicationContext;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="title function_">SpringBeanUtils</span><span class="params">()</span> &#123;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> SpringBeanUtils <span class="title function_">getInstance</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> INSTANCE;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@SuppressWarnings(&quot;all&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> &lt;T&gt; T <span class="title function_">getBean</span><span class="params">(<span class="keyword">final</span> String beanName)</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> (T) applicationContext.getBean(beanName);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> &lt;T&gt; T <span class="title function_">getBean</span><span class="params">(String name, Class&lt;T&gt; requiredType)</span> <span class="keyword">throws</span> BeansException &#123;</span><br><span class="line">        <span class="keyword">return</span> applicationContext.getBean(name, requiredType);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">registerSingleton</span><span class="params">(String beanName, Object singletonObject)</span> &#123;</span><br><span class="line">        <span class="type">DefaultListableBeanFactory</span> <span class="variable">beanFactory</span> <span class="operator">=</span> getBeanFactory();</span><br><span class="line">        beanFactory.registerSingleton(beanName, singletonObject);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">destroySingleton</span><span class="params">(String beanName)</span> &#123;</span><br><span class="line">        <span class="type">DefaultListableBeanFactory</span> <span class="variable">beanFactory</span> <span class="operator">=</span> getBeanFactory();</span><br><span class="line">        beanFactory.destroySingleton(beanName);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="type">boolean</span> <span class="title function_">containsSingleton</span><span class="params">(String beanName)</span> &#123;</span><br><span class="line">        <span class="type">DefaultListableBeanFactory</span> <span class="variable">beanFactory</span> <span class="operator">=</span> getBeanFactory();</span><br><span class="line">        <span class="keyword">return</span> beanFactory.containsSingleton(beanName);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> DefaultListableBeanFactory <span class="title function_">getBeanFactory</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="type">ConfigurableApplicationContext</span> <span class="variable">configurableApplicationContext</span> <span class="operator">=</span> (ConfigurableApplicationContext) applicationContext;</span><br><span class="line">        <span class="keyword">return</span> (DefaultListableBeanFactory) configurableApplicationContext.getBeanFactory();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setApplicationContext</span><span class="params">(<span class="keyword">final</span> ApplicationContext applicationContext)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.applicationContext = applicationContext;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> ApplicationContext <span class="title function_">getApplicationContext</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> applicationContext;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="动态路由"><a href="#动态路由" class="headerlink" title="动态路由"></a>动态路由</h2><p>Spring Boot 应用通过 <code>RouterFunction</code> 暴露 MCP 服务器的访问端点，然而 Spring Boot 的路由是静态的，在应用启动时就要定义好，在应用运行过程中没有办法动态地增加&#x2F;删除路由，因此无法实现动态创建&#x2F;销毁 MCP 服务器。要实现动态创建&#x2F;销毁 MCP 服务器需要自己来管理路由，在这个管理器中存储所有 MCP 服务器的路由信息，即 <code>routerFunction</code> 变量</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> org.springframework.web.reactive.function.server.RouterFunction;</span><br><span class="line"><span class="keyword">import</span> reactor.core.publisher.Mono;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">DynamicRouterFunctionManager</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> RouterFunction&lt;?&gt; EMPTY_ROUTER_FUNCTION = request -&gt; Mono.empty();</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> RouterFunction&lt;?&gt; routerFunction;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">DynamicRouterFunctionManager</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.routerFunction = EMPTY_ROUTER_FUNCTION;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">synchronized</span> <span class="keyword">void</span> <span class="title function_">refreshRouterFunction</span><span class="params">(RouterFunction&lt;?&gt; routerFunction)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.routerFunction = routerFunction != <span class="literal">null</span> ? routerFunction : EMPTY_ROUTER_FUNCTION;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">synchronized</span> RouterFunction&lt;?&gt; gettingRouterFunction() &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">this</span>.routerFunction;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>有了路由管理器后就可以向 Spring 容器中注册一个顶级 <code>RouterFunction</code>，它的 <code>route</code> 方法从路由管理器中获取路由，然后返回与请求匹配的 <code>HandlerFunction</code></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Bean</span></span><br><span class="line"><span class="meta">@SuppressWarnings(&quot;unchecked&quot;)</span></span><br><span class="line"><span class="keyword">public</span> RouterFunction&lt;?&gt; dynamicMcpRouterFunction(DynamicRouterFunctionManager dynamicRouterFunctionManager) &#123;</span><br><span class="line">    <span class="keyword">return</span> request -&gt; dynamicRouterFunctionManager.gettingRouterFunction()</span><br><span class="line">            .route(request)</span><br><span class="line">            .map(handler -&gt; (HandlerFunction&lt;ServerResponse&gt;) handler);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="动态服务"><a href="#动态服务" class="headerlink" title="动态服务"></a>动态服务</h2><p>动态创建 MCP 服务器的时机为应用启动完成后，因此监听 Spring 容器的 <code>ApplicationReadyEvent</code>，此时会完成 3 件事情：1、根据配置的协议类型创建对应的 <code>TransportProvider</code> 和 <code>McpServer</code>；2、缓存 MCP 服务器的配置信息和 <code>RouterFunction</code>；3、使用当前的 <code>RouterFunction</code> 重建路由。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> com.fasterxml.jackson.databind.ObjectMapper;</span><br><span class="line"><span class="keyword">import</span> io.modelcontextprotocol.json.jackson.JacksonMcpJsonMapper;</span><br><span class="line"><span class="keyword">import</span> io.modelcontextprotocol.server.McpAsyncServer;</span><br><span class="line"><span class="keyword">import</span> io.modelcontextprotocol.server.McpServer;</span><br><span class="line"><span class="keyword">import</span> io.modelcontextprotocol.server.transport.WebFluxSseServerTransportProvider;</span><br><span class="line"><span class="keyword">import</span> io.modelcontextprotocol.server.transport.WebFluxStreamableServerTransportProvider;</span><br><span class="line"><span class="keyword">import</span> io.modelcontextprotocol.spec.McpSchema;</span><br><span class="line"><span class="keyword">import</span> org.springframework.ai.mcp.McpToolUtils;</span><br><span class="line"><span class="keyword">import</span> org.springframework.ai.mcp.server.common.autoconfigure.properties.McpServerProperties;</span><br><span class="line"><span class="keyword">import</span> org.springframework.ai.support.ToolCallbacks;</span><br><span class="line"><span class="keyword">import</span> org.springframework.ai.tool.ToolCallback;</span><br><span class="line"><span class="keyword">import</span> org.springframework.beans.factory.DisposableBean;</span><br><span class="line"><span class="keyword">import</span> org.springframework.boot.context.event.ApplicationReadyEvent;</span><br><span class="line"><span class="keyword">import</span> org.springframework.context.event.EventListener;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.reactive.function.server.RouterFunction;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.time.Duration;</span><br><span class="line"><span class="keyword">import</span> java.util.ArrayList;</span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"><span class="keyword">import</span> java.util.Map;</span><br><span class="line"><span class="keyword">import</span> java.util.concurrent.ConcurrentHashMap;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">DynamicMcpServerManager</span> <span class="keyword">implements</span> <span class="title class_">DisposableBean</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">String</span> <span class="variable">BEAN_NAME_PREFIX</span> <span class="operator">=</span> DynamicMcpServerManager.class.getName() + <span class="string">&quot;.&quot;</span>;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">String</span> <span class="variable">TRANSPORT_PROVIDER_BEAN_NAME_PREFIX</span> <span class="operator">=</span> BEAN_NAME_PREFIX + <span class="string">&quot;transportProvider.&quot;</span>;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">String</span> <span class="variable">MCP_SERVER_BEAN_NAME_PREFIX</span> <span class="operator">=</span> BEAN_NAME_PREFIX + <span class="string">&quot;mcpServer.&quot;</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> Map&lt;String, DynamicMcpServerProperties.ServerParameters&gt; ACTIVE_MCP_SERVERS = <span class="keyword">new</span> <span class="title class_">ConcurrentHashMap</span>&lt;&gt;();</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> Map&lt;String, RouterFunction&lt;?&gt;&gt; ACTIVE_ROUTER_FUNCTIONS = <span class="keyword">new</span> <span class="title class_">ConcurrentHashMap</span>&lt;&gt;();</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> ObjectMapper objectMapper;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> DynamicMcpServerProperties dynamicMcpServerProperties;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> DynamicRouterFunctionManager dynamicRouterFunctionManager;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">DynamicMcpServerManager</span><span class="params">(ObjectMapper objectMapper, DynamicMcpServerProperties dynamicMcpServerProperties, DynamicRouterFunctionManager dynamicRouterFunctionManager)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.objectMapper = objectMapper;</span><br><span class="line">        <span class="built_in">this</span>.dynamicMcpServerProperties = dynamicMcpServerProperties;</span><br><span class="line">        <span class="built_in">this</span>.dynamicRouterFunctionManager = dynamicRouterFunctionManager;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">destroy</span><span class="params">()</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">        stopMcpServer();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@EventListener(value = &#123;ApplicationReadyEvent.class&#125;)</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">onApplicationReady</span><span class="params">(ApplicationReadyEvent event)</span> &#123;</span><br><span class="line">        startMcpServer();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">void</span> <span class="title function_">startMcpServer</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">for</span> (Map.Entry&lt;String, DynamicMcpServerProperties.ServerParameters&gt; entry : <span class="built_in">this</span>.dynamicMcpServerProperties.getServers().entrySet()) &#123;</span><br><span class="line">            <span class="type">String</span> <span class="variable">serverName</span> <span class="operator">=</span> entry.getKey();</span><br><span class="line">            DynamicMcpServerProperties.<span class="type">ServerParameters</span> <span class="variable">serverParameters</span> <span class="operator">=</span> entry.getValue();</span><br><span class="line">            <span class="keyword">if</span> (!serverParameters.isEnabled()) &#123;</span><br><span class="line">                <span class="keyword">continue</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            startMcpServer(serverName, serverParameters);</span><br><span class="line">            ACTIVE_MCP_SERVERS.put(serverName, serverParameters);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">void</span> <span class="title function_">startMcpServer</span><span class="params">(String serverName, DynamicMcpServerProperties.ServerParameters serverParameters)</span> &#123;</span><br><span class="line">        List&lt;Object&gt; toolObjects = <span class="keyword">new</span> <span class="title class_">ArrayList</span>&lt;&gt;();</span><br><span class="line">        <span class="keyword">for</span> (String toolObjectName : serverParameters.getToolObjectNames()) &#123;</span><br><span class="line">            toolObjects.add(SpringBeanUtils.getInstance().getBean(toolObjectName));</span><br><span class="line">        &#125;</span><br><span class="line">        ToolCallback[] toolCallbacks = ToolCallbacks.from(toolObjects.toArray());</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (serverParameters.getProtocol() == McpServerProperties.ServerProtocol.SSE) &#123;</span><br><span class="line">            <span class="type">String</span> <span class="variable">messageEndpoint</span> <span class="operator">=</span> <span class="string">&quot;/&quot;</span> + serverName + <span class="string">&quot;/mcp/message&quot;</span>;</span><br><span class="line">            <span class="type">String</span> <span class="variable">sseEndpoint</span> <span class="operator">=</span> <span class="string">&quot;/&quot;</span> + serverName + <span class="string">&quot;/sse&quot;</span>;</span><br><span class="line">            <span class="type">WebFluxSseServerTransportProvider</span> <span class="variable">transportProvider</span> <span class="operator">=</span> WebFluxSseServerTransportProvider.builder()</span><br><span class="line">                    .jsonMapper(<span class="keyword">new</span> <span class="title class_">JacksonMcpJsonMapper</span>(<span class="built_in">this</span>.objectMapper))</span><br><span class="line">                    .messageEndpoint(messageEndpoint)</span><br><span class="line">                    .sseEndpoint(sseEndpoint)</span><br><span class="line">                    .keepAliveInterval(Duration.ofHours(<span class="number">24</span>))</span><br><span class="line">                    .build();</span><br><span class="line">            SpringBeanUtils.getInstance().registerSingleton(TRANSPORT_PROVIDER_BEAN_NAME_PREFIX + serverName, transportProvider);</span><br><span class="line"></span><br><span class="line">            <span class="type">McpAsyncServer</span> <span class="variable">mcpServer</span> <span class="operator">=</span> McpServer.async(transportProvider)</span><br><span class="line">                    .serverInfo(serverName, serverParameters.getVersion())</span><br><span class="line">                    .capabilities(McpSchema.ServerCapabilities.builder()</span><br><span class="line">                            .tools(<span class="literal">true</span>)</span><br><span class="line">                            .logging()</span><br><span class="line">                            .build())</span><br><span class="line">                    .tools(McpToolUtils.toAsyncToolSpecifications(toolCallbacks))</span><br><span class="line">                    .build();</span><br><span class="line">            SpringBeanUtils.getInstance().registerSingleton(MCP_SERVER_BEAN_NAME_PREFIX + serverName, mcpServer);</span><br><span class="line"></span><br><span class="line">            RouterFunction&lt;?&gt; routerFunction = transportProvider.getRouterFunction();</span><br><span class="line">            ACTIVE_ROUTER_FUNCTIONS.put(serverName, routerFunction);</span><br><span class="line">            rebuildRouterFunction();</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (serverParameters.getProtocol() == McpServerProperties.ServerProtocol.STREAMABLE) &#123;</span><br><span class="line">            <span class="type">String</span> <span class="variable">messageEndpoint</span> <span class="operator">=</span> <span class="string">&quot;/&quot;</span> + serverName + <span class="string">&quot;/mcp&quot;</span>;</span><br><span class="line">            <span class="type">WebFluxStreamableServerTransportProvider</span> <span class="variable">transportProvider</span> <span class="operator">=</span> WebFluxStreamableServerTransportProvider.builder()</span><br><span class="line">                    .jsonMapper(<span class="keyword">new</span> <span class="title class_">JacksonMcpJsonMapper</span>(<span class="built_in">this</span>.objectMapper))</span><br><span class="line">                    .messageEndpoint(messageEndpoint)</span><br><span class="line">                    .keepAliveInterval(Duration.ofHours(<span class="number">24</span>))</span><br><span class="line">                    .disallowDelete(<span class="literal">false</span>)</span><br><span class="line">                    .build();</span><br><span class="line">            SpringBeanUtils.getInstance().registerSingleton(TRANSPORT_PROVIDER_BEAN_NAME_PREFIX + serverName, transportProvider);</span><br><span class="line"></span><br><span class="line">            <span class="type">McpAsyncServer</span> <span class="variable">mcpServer</span> <span class="operator">=</span> McpServer.async(transportProvider)</span><br><span class="line">                    .serverInfo(serverName, serverParameters.getVersion())</span><br><span class="line">                    .capabilities(McpSchema.ServerCapabilities.builder()</span><br><span class="line">                            .tools(<span class="literal">true</span>)</span><br><span class="line">                            .logging()</span><br><span class="line">                            .build())</span><br><span class="line">                    .tools(McpToolUtils.toAsyncToolSpecifications(toolCallbacks))</span><br><span class="line">                    .build();</span><br><span class="line">            SpringBeanUtils.getInstance().registerSingleton(MCP_SERVER_BEAN_NAME_PREFIX + serverName, mcpServer);</span><br><span class="line"></span><br><span class="line">            RouterFunction&lt;?&gt; routerFunction = transportProvider.getRouterFunction();</span><br><span class="line">            ACTIVE_ROUTER_FUNCTIONS.put(serverName, routerFunction);</span><br><span class="line">            rebuildRouterFunction();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">void</span> <span class="title function_">rebuildRouterFunction</span><span class="params">()</span> &#123;</span><br><span class="line">        RouterFunction&lt;?&gt; combined = ACTIVE_ROUTER_FUNCTIONS.values().stream().reduce(RouterFunction::andOther).orElse(<span class="literal">null</span>);</span><br><span class="line">        dynamicRouterFunctionManager.refreshRouterFunction(combined);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">void</span> <span class="title function_">stopMcpServer</span><span class="params">()</span> &#123;</span><br><span class="line">        ACTIVE_MCP_SERVERS.forEach(<span class="built_in">this</span>::stopMcpServer);</span><br><span class="line">        ACTIVE_MCP_SERVERS.clear();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">void</span> <span class="title function_">stopMcpServer</span><span class="params">(String serverName, DynamicMcpServerProperties.ServerParameters serverParameters)</span> &#123;</span><br><span class="line">        ACTIVE_MCP_SERVERS.remove(serverName);</span><br><span class="line">        rebuildRouterFunction();</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (SpringBeanUtils.getInstance().containsSingleton(MCP_SERVER_BEAN_NAME_PREFIX + serverName)) &#123;</span><br><span class="line">            SpringBeanUtils.getInstance().destroySingleton(MCP_SERVER_BEAN_NAME_PREFIX + serverName);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (SpringBeanUtils.getInstance().containsSingleton(TRANSPORT_PROVIDER_BEAN_NAME_PREFIX + serverName)) &#123;</span><br><span class="line">            <span class="keyword">if</span> (ACTIVE_MCP_SERVERS.get(serverName).getProtocol() == McpServerProperties.ServerProtocol.SSE) &#123;</span><br><span class="line">                <span class="type">WebFluxSseServerTransportProvider</span> <span class="variable">transportProvider</span> <span class="operator">=</span> SpringBeanUtils.getInstance().getBean(TRANSPORT_PROVIDER_BEAN_NAME_PREFIX + serverName, WebFluxSseServerTransportProvider.class);</span><br><span class="line">                transportProvider.close();</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">if</span> (ACTIVE_MCP_SERVERS.get(serverName).getProtocol() == McpServerProperties.ServerProtocol.STREAMABLE) &#123;</span><br><span class="line">                <span class="type">WebFluxStreamableServerTransportProvider</span> <span class="variable">transportProvider</span> <span class="operator">=</span> SpringBeanUtils.getInstance().getBean(TRANSPORT_PROVIDER_BEAN_NAME_PREFIX + serverName, WebFluxStreamableServerTransportProvider.class);</span><br><span class="line">                transportProvider.close();</span><br><span class="line">            &#125;</span><br><span class="line">            SpringBeanUtils.getInstance().destroySingleton(TRANSPORT_PROVIDER_BEAN_NAME_PREFIX + serverName);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>另外，现在与 MCP 相关的对象都由我们自己管理，因此也提供了在容器销毁时的销毁方法 <code>stopMcpServer</code>。这个功能在当前的实现中作用并不明显，当使用数据库作为存储配置的源时，这个功能就会有作用，此时可能会有一个管理后台来维护配置，进行 MCP 服务器的启&#x2F;停，工具的增&#x2F;删。比如在管理后台维护配置后向 Redis 发送一条广播消息，在 MCP 服务器中监听到这个消息后，就可以根据消息中的内容来启动&#x2F;停止 MCP 服务器。下面是一个示例</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Bean</span></span><br><span class="line"><span class="keyword">public</span> RedisMessageListenerContainer <span class="title function_">messageListenerContainer</span><span class="params">(RedisConnectionFactory connectionFactory, DynamicMcpServerManager dynamicMcpServerManager)</span> &#123;</span><br><span class="line">    <span class="type">RedisMessageListenerContainer</span> <span class="variable">container</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">RedisMessageListenerContainer</span>();</span><br><span class="line">    container.setConnectionFactory(connectionFactory);</span><br><span class="line">    container.addMessageListener(</span><br><span class="line">            (message, pattern) -&gt; &#123;</span><br><span class="line">                <span class="type">String</span> <span class="variable">mcpServerName</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">String</span>(message.getBody(), StandardCharsets.UTF_8);</span><br><span class="line">                dynamicMcpServerManager.startMcpServer(mcpServerName);</span><br><span class="line">            &#125;,</span><br><span class="line">            <span class="keyword">new</span> <span class="title class_">ChannelTopic</span>(<span class="string">&quot;spring:ai:mcp:server:dynamic:server:start&quot;</span>)</span><br><span class="line">    );</span><br><span class="line">    container.addMessageListener(</span><br><span class="line">            (message, pattern) -&gt; &#123;</span><br><span class="line">                <span class="type">String</span> <span class="variable">mcpServerName</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">String</span>(message.getBody(), StandardCharsets.UTF_8);</span><br><span class="line">                dynamicMcpServerManager.stopMcpServer(mcpServerName);</span><br><span class="line">            &#125;,</span><br><span class="line">            <span class="keyword">new</span> <span class="title class_">ChannelTopic</span>(<span class="string">&quot;spring:ai:mcp:server:dynamic:server:stop&quot;</span>)</span><br><span class="line">    );</span><br><span class="line">    container.addMessageListener(</span><br><span class="line">            (message, pattern) -&gt; &#123;</span><br><span class="line">                <span class="type">String</span> <span class="variable">mcpServerName</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">String</span>(message.getBody(), StandardCharsets.UTF_8);</span><br><span class="line">                dynamicMcpServerManager.syncMcpTool(mcpServerName);</span><br><span class="line">            &#125;,</span><br><span class="line">            <span class="keyword">new</span> <span class="title class_">ChannelTopic</span>(<span class="string">&quot;spring:ai:mcp:server:dynamic:tool:change&quot;</span>)</span><br><span class="line">    );</span><br><span class="line">    <span class="keyword">return</span> container;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>在 <code>DynamicMcpServerManager</code> 中添加了 <code>startMcpServer</code>、<code>stopMcpServer</code> 和 <code>syncMcpTool</code> 方法，其中 <code>syncMcpTool</code> 方法只简单实现了添加工具功能，没有实现删除工具的功能，想要实现真正的工具同步功能还需要实现工具历史工具和最新工具之间的比较逻辑，这部分需要根据实际需求进行实现。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">DynamicMcpServerManager</span> <span class="keyword">implements</span> <span class="title class_">DisposableBean</span> &#123;</span><br><span class="line">    <span class="comment">// 省略了...</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">startMcpServer</span><span class="params">(String serverName)</span> &#123;</span><br><span class="line">        DynamicMcpServerProperties.<span class="type">ServerParameters</span> <span class="variable">serverParameters</span> <span class="operator">=</span> <span class="built_in">this</span>.dynamicMcpServerProperties.getServers().get(serverName);</span><br><span class="line">        startMcpServer(serverName, serverParameters);</span><br><span class="line">        ACTIVE_MCP_SERVERS.put(serverName, serverParameters);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">stopMcpServer</span><span class="params">(String serverName)</span> &#123;</span><br><span class="line">        DynamicMcpServerProperties.<span class="type">ServerParameters</span> <span class="variable">serverParameters</span> <span class="operator">=</span> ACTIVE_MCP_SERVERS.get(serverName);</span><br><span class="line">        stopMcpServer(serverName, serverParameters);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">syncMcpTool</span><span class="params">(String serverName)</span> &#123;</span><br><span class="line">        DynamicMcpServerProperties.<span class="type">ServerParameters</span> <span class="variable">serverParameters</span> <span class="operator">=</span> <span class="built_in">this</span>.dynamicMcpServerProperties.getServers().get(serverName);</span><br><span class="line">        List&lt;Object&gt; toolObjects = <span class="keyword">new</span> <span class="title class_">ArrayList</span>&lt;&gt;();</span><br><span class="line">        <span class="keyword">for</span> (String toolObjectName : serverParameters.getToolObjectNames()) &#123;</span><br><span class="line">            toolObjects.add(SpringBeanUtils.getInstance().getBean(toolObjectName));</span><br><span class="line">        &#125;</span><br><span class="line">        ToolCallback[] toolCallbacks = ToolCallbacks.from(toolObjects.toArray());</span><br><span class="line">        <span class="type">McpAsyncServer</span> <span class="variable">mcpServer</span> <span class="operator">=</span> SpringBeanUtils.getInstance().getBean(MCP_SERVER_BEAN_NAME_PREFIX + serverName, McpAsyncServer.class);</span><br><span class="line">        <span class="keyword">for</span> (ToolCallback toolCallback : toolCallbacks) &#123;</span><br><span class="line">            mcpServer.addTool(McpToolUtils.toAsyncToolSpecification(toolCallback)).block();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 省略了...</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="整合集成"><a href="#整合集成" class="headerlink" title="整合集成"></a>整合集成</h2><p>现在需要的所有组件都已经实现，下面需要做的就是把它们集成起来</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> com.fasterxml.jackson.databind.ObjectMapper;</span><br><span class="line"><span class="keyword">import</span> org.springframework.beans.BeansException;</span><br><span class="line"><span class="keyword">import</span> org.springframework.beans.factory.annotation.Qualifier;</span><br><span class="line"><span class="keyword">import</span> org.springframework.context.ApplicationContext;</span><br><span class="line"><span class="keyword">import</span> org.springframework.context.ApplicationContextAware;</span><br><span class="line"><span class="keyword">import</span> org.springframework.context.annotation.Bean;</span><br><span class="line"><span class="keyword">import</span> org.springframework.context.annotation.Configuration;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.reactive.function.server.HandlerFunction;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.reactive.function.server.RouterFunction;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.reactive.function.server.ServerResponse;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Configuration</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">DynamicMcpServerConfiguration</span> <span class="keyword">implements</span> <span class="title class_">ApplicationContextAware</span> &#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setApplicationContext</span><span class="params">(ApplicationContext applicationContext)</span> <span class="keyword">throws</span> BeansException &#123;</span><br><span class="line">        SpringBeanUtils.getInstance().setApplicationContext(applicationContext);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">    <span class="keyword">public</span> DynamicMcpServerProperties <span class="title function_">dynamicMcpServerProperties</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">DynamicMcpServerProperties</span>();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">    <span class="keyword">public</span> DynamicRouterFunctionManager <span class="title function_">dynamicRouterFunctionManager</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">DynamicRouterFunctionManager</span>();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">    <span class="meta">@SuppressWarnings(&quot;unchecked&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> RouterFunction&lt;?&gt; dynamicMcpRouterFunction(DynamicRouterFunctionManager dynamicRouterFunctionManager) &#123;</span><br><span class="line">        <span class="keyword">return</span> request -&gt; dynamicRouterFunctionManager.gettingRouterFunction()</span><br><span class="line">                .route(request)</span><br><span class="line">                .map(handler -&gt; (HandlerFunction&lt;ServerResponse&gt;) handler);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">    <span class="keyword">public</span> DynamicMcpServerManager <span class="title function_">dynamicMcpServerManager</span><span class="params">(<span class="meta">@Qualifier(&quot;mcpServerObjectMapper&quot;)</span> ObjectMapper objectMapper, DynamicMcpServerProperties dynamicMcpServerProperties, DynamicRouterFunctionManager dynamicRouterFunctionManager)</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">DynamicMcpServerManager</span>(objectMapper, dynamicMcpServerProperties, dynamicRouterFunctionManager);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>至此，一个简易版本的动态创建&#x2F;销毁 MCP 服务器的功能就实现好了，完整的代码示例在 <a target="_blank" rel="noopener" href="https://github.com/acomma/examples/tree/main/example-mcp/mcp-server-dynamic">Github</a>。</p>
<h2 id="参考资料"><a href="#参考资料" class="headerlink" title="参考资料"></a>参考资料</h2><ol>
<li><a target="_blank" rel="noopener" href="https://github.com/spring-projects/spring-ai/issues/3515">spring ai mcp server multi-instance solution</a></li>
<li><a target="_blank" rel="noopener" href="https://spring.io/blog/2025/05/04/spring-ai-dynamic-tool-updates-with-mcp">Dynamic Tool Updates in Spring AI’s Model Context Protocol</a></li>
</ol>

    </div>

    
    
    

    <footer class="post-footer">
          

<div class="post-copyright">
<ul>
  <li class="post-copyright-author">
      <strong>本文作者： </strong>逗号
  </li>
  <li class="post-copyright-link">
      <strong>本文链接：</strong>
      <a href="https://acomma.github.io/2025/11/15/dynamic-server-in-spring-ai-model-context-protocol/" title="在 Spring Boot 应用中动态创建&#x2F;销毁 MCP 服务器">https://acomma.github.io/2025/11/15/dynamic-server-in-spring-ai-model-context-protocol/</a>
  </li>
  <li class="post-copyright-license">
      <strong>版权声明： </strong>本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/deed.zh" rel="noopener" target="_blank"><i class="fab fa-fw fa-creative-commons"></i>BY-NC-SA</a> 许可协议。转载请注明出处！
  </li>
</ul>
</div>

          <div class="post-tags">
              <a href="/tags/Spring-AI/" rel="tag"><i class="fa fa-tag"></i> Spring AI</a>
              <a href="/tags/MCP/" rel="tag"><i class="fa fa-tag"></i> MCP</a>
          </div>

        

          <div class="post-nav">
            <div class="post-nav-item">
                <a href="/2025/09/03/spring-ai-mcp-invocation-process/" rel="prev" title="Spring AI MCP 源码分析">
                  <i class="fa fa-angle-left"></i> Spring AI MCP 源码分析
                </a>
            </div>
            <div class="post-nav-item">
                <a href="/2025/11/19/how-to-remove-self-intersect-part-in-postgis/" rel="next" title="如何在 PostGIS 中删除 LINESTRING 自相交部分">
                  如何在 PostGIS 中删除 LINESTRING 自相交部分 <i class="fa fa-angle-right"></i>
                </a>
            </div>
          </div>
    </footer>
  </article>
</div>






</div>
  </main>

  <footer class="footer">
    <div class="footer-inner">

  <div class="copyright">
    &copy; 
    <span itemprop="copyrightYear">2025</span>
    <span class="with-love">
      <i class="fa fa-heart"></i>
    </span>
    <span class="author" itemprop="copyrightHolder">逗号</span>
  </div>
  <div class="powered-by">由 <a href="https://hexo.io/" rel="noopener" target="_blank">Hexo</a> & <a href="https://theme-next.js.org/pisces/" rel="noopener" target="_blank">NexT.Pisces</a> 强力驱动
  </div>

    </div>
  </footer>

  
  <div class="toggle sidebar-toggle" role="button">
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
  </div>
  <div class="sidebar-dimmer"></div>
  <div class="back-to-top" role="button" aria-label="返回顶部">
    <i class="fa fa-arrow-up fa-lg"></i>
    <span>0%</span>
  </div>
  <div class="reading-progress-bar"></div>

  <a href="https://github.com/acomma" class="github-corner" title="在 GitHub 上关注我" aria-label="在 GitHub 上关注我" rel="noopener" target="_blank"><svg width="80" height="80" viewBox="0 0 250 250" aria-hidden="true"><path d="M0,0 L115,115 L130,115 L142,142 L250,250 L250,0 Z"></path><path d="M128.3,109.0 C113.8,99.7 119.0,89.6 119.0,89.6 C122.0,82.7 120.5,78.6 120.5,78.6 C119.2,72.0 123.4,76.3 123.4,76.3 C127.3,80.9 125.5,87.3 125.5,87.3 C122.9,97.6 130.6,101.9 134.4,103.2" fill="currentColor" style="transform-origin: 130px 106px;" class="octo-arm"></path><path d="M115.0,115.0 C114.9,115.1 118.7,116.5 119.8,115.4 L133.7,101.6 C136.9,99.2 139.9,98.4 142.2,98.6 C133.8,88.0 127.5,74.4 143.8,58.0 C148.5,53.4 154.0,51.2 159.7,51.0 C160.3,49.4 163.2,43.6 171.4,40.1 C171.4,40.1 176.1,42.5 178.8,56.2 C183.1,58.6 187.2,61.8 190.9,65.4 C194.5,69.0 197.7,73.2 200.1,77.6 C213.8,80.2 216.3,84.9 216.3,84.9 C212.7,93.1 206.9,96.0 205.4,96.6 C205.1,102.4 203.0,107.8 198.3,112.5 C181.9,128.9 168.3,122.5 157.7,114.1 C157.9,116.9 156.7,120.9 152.7,124.9 L141.0,136.5 C139.8,137.7 141.6,141.9 141.8,141.8 Z" fill="currentColor" class="octo-body"></path></svg></a>

<noscript>
  <div class="noscript-warning">Theme NexT works best with JavaScript enabled</div>
</noscript>

</body>
</html>
